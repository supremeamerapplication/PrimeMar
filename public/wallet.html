<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet - PrimeMar</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/wallet.css">
    <link rel="icon" href="./assets/icons/primebird.svg" type="image/svg+xml">
</head>
<body>
    <div class="app-container">
        <nav class="navigation">
            <div class="nav-container">
                <div class="nav-logo">
                    <img src="./assets/icons/primebird.svg" alt="PrimeMar" class="logo-icon">
                    <span>PrimeMar</span>
                </div>
                <div class="nav-menu" id="navMenu">
                    <a href="./feed.html" class="nav-link">Feed</a>
                    <a href="./profile.html" class="nav-link">Profile</a>
                    <a href="./messages.html" class="nav-link">Messages</a>
                    <a href="./wallet.html" class="nav-link active">Wallet</a>
                    <a href="./settings.html" class="nav-link">Settings</a>
                    <a href="javascript:void(0)" class="nav-link" id="logoutLink">Logout</a>
                </div>
                <div class="nav-toggle" id="navToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </nav>

        <div class="wallet-container">
            <!-- Wallet Summary -->
            <section class="wallet-summary">
                <div class="balance-card">
                    <h2>Total SA Balance</h2>
                    <div class="balance-display">
                        <span class="balance-value" id="totalBalance">0</span>
                        <span class="balance-currency">SA</span>
                    </div>
                    <div class="balance-breakdown">
                        <div class="breakdown-item">
                            <span class="label">Available</span>
                            <span class="value" id="availableBalance">0 SA</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="label">On Hold</span>
                            <span class="value" id="onHoldBalance">0 SA</span>
                        </div>
                    </div>
                </div>

                <div class="conversion-card">
                    <h3>Quick Conversion</h3>
                    <div class="conversion-box">
                        <div class="conversion-input">
                            <input type="number" id="convertAmount" placeholder="Enter SA amount" min="1">
                            <select id="convertCurrency">
                                <option value="USD">USD</option>
                                <option value="NGN">NGN</option>
                            </select>
                        </div>
                        <div class="conversion-result">
                            <span id="convertResult">0.00</span>
                        </div>
                        <button class="btn btn-primary btn-block" id="convertBtn">Convert</button>
                    </div>
                </div>
            </section>

            <!-- Wallet Tabs -->
            <div class="wallet-tabs">
                <button class="tab-btn active" data-tab="overview">Overview</button>
                <button class="tab-btn" data-tab="transactions">Transactions</button>
                <button class="tab-btn" data-tab="withdrawals">Withdrawals</button>
                <button class="tab-btn" data-tab="boost">Boost History</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Overview Tab -->
                <div id="overviewTab" class="tab-panel active">
                    <div class="grid">
                        <div class="card">
                            <h3>SA Earned This Month</h3>
                            <p class="stat-value" id="monthlyEarned">0</p>
                        </div>
                        <div class="card">
                            <h3>Total Conversions</h3>
                            <p class="stat-value" id="totalConversions">0</p>
                        </div>
                        <div class="card">
                            <h3>Total Withdrawn</h3>
                            <p class="stat-value" id="totalWithdrawn">$0.00</p>
                        </div>
                        <div class="card">
                            <h3>Active Boosts</h3>
                            <p class="stat-value" id="activeBoosts">0</p>
                        </div>
                    </div>

                    <div class="earnings-chart">
                        <h3>Earnings Overview</h3>
                        <div id="earningsChartContainer" class="chart-container">
                            <canvas id="earningsChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Transactions Tab -->
                <div id="transactionsTab" class="tab-panel">
                    <div class="filter-controls">
                        <select id="transactionTypeFilter">
                            <option value="">All Types</option>
                            <option value="earn">Earnings</option>
                            <option value="boost">Boost</option>
                            <option value="conversion">Conversion</option>
                        </select>
                        <input type="date" id="dateFilter">
                    </div>
                    <div id="transactionsList" class="transactions-list">
                        <div class="loading">Loading transactions...</div>
                    </div>
                </div>

                <!-- Withdrawals Tab -->
                <div id="withdrawalsTab" class="tab-panel">
                    <div class="withdrawal-form-container">
                        <div class="card">
                            <h3>Request Withdrawal</h3>
                            <form id="withdrawalForm" class="form">
                                <div class="form-group">
                                    <label for="withdrawAmount">Amount</label>
                                    <div class="amount-input">
                                        <input type="number" id="withdrawAmount" placeholder="0" min="5" step="0.01" required>
                                        <select id="withdrawCurrency">
                                            <option value="USD">USD</option>
                                            <option value="NGN">NGN</option>
                                        </select>
                                    </div>
                                    <small id="withdrawalWarning"></small>
                                </div>

                                <div class="form-group">
                                    <label for="withdrawMethod">Withdrawal Method</label>
                                    <select id="withdrawMethod" required>
                                        <option value="">Select method</option>
                                        <option value="paystack">Paystack (NGN)</option>
                                        <option value="flutterwave">Flutterwave (USD/NGN)</option>
                                        <option value="bank">Bank Transfer</option>
                                    </select>
                                </div>

                                <div id="methodDetails" class="form-group"></div>

                                <button type="submit" class="btn btn-primary btn-block" id="submitWithdrawalBtn">Request Withdrawal</button>
                            </form>
                        </div>
                    </div>

                    <div class="withdrawal-history">
                        <h3>Withdrawal History</h3>
                        <div id="withdrawalsList" class="withdrawals-list">
                            <div class="loading">Loading withdrawals...</div>
                        </div>
                    </div>
                </div>

                <!-- Boost History Tab -->
                <div id="boostTab" class="tab-panel">
                    <div class="boost-info-card">
                        <h3>About Boosts</h3>
                        <p>Boost your Connects for increased visibility. Cost: 100 SA for 24 hours</p>
                        <p><strong>SA Distribution:</strong></p>
                        <ul>
                            <li>Creator: 50 SA</li>
                            <li>Platform: 30 SA</li>
                            <li>Reserve: 20 SA</li>
                        </ul>
                    </div>

                    <div id="boostHistory" class="boosts-list">
                        <div class="loading">Loading boost history...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Withdrawal Confirmation Modal -->
    <div class="modal" id="withdrawalConfirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirm Withdrawal</h2>
                <button class="modal-close" id="closeWithdrawalModal">&times;</button>
            </div>
            <div id="withdrawalSummary" class="summary"></div>
            <div class="modal-actions">
                <button class="btn btn-primary" id="confirmWithdrawalBtn">Confirm</button>
                <button class="btn btn-secondary" id="cancelWithdrawalBtn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Conversion Success Modal -->
    <div class="modal" id="conversionSuccessModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Conversion Complete</h2>
                <button class="modal-close" id="closeConversionModal">&times;</button>
            </div>
            <div id="conversionDetails" class="details"></div>
            <button class="btn btn-primary btn-block" id="closeConversionDetailsBtn">Done</button>
        </div>
    </div>

    <script src="../js/config/supabase.js"></script>
    <script src="../js/config/constants.js"></script>
    <script src="../js/utils/validation.js"></script>
    <script src="../js/utils/helpers.js"></script>
    <script src="../js/auth/session.js"></script>
    <script src="../js/wallet/wallet.js"></script>
    <script src="../js/wallet/conversions.js"></script>
    <script src="../js/wallet/withdrawals.js"></script>
    <script src="../js/wallet/boost.js"></script>
    <script src="../js/payments/paystack.js"></script>
    <script src="../js/payments/flutterwave.js"></script>
</body>
</html>
