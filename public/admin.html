<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - PrimeMar</title>
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/admin.css">
    <link rel="icon" href="./assets/icons/primebird.svg" type="image/svg+xml">
</head>
<body>
    <div class="app-container">
        <nav class="admin-nav">
            <div class="nav-container">
                <div class="nav-logo">
                    <img src="./assets/icons/primebird.svg" alt="PrimeMar" class="logo-icon">
                    <span>PrimeMar Admin</span>
                </div>
                <div class="nav-menu">
                    <a href="javascript:void(0)" class="nav-link" id="adminLogoutLink">Logout</a>
                </div>
            </div>
        </nav>

        <div class="admin-container">
            <!-- Sidebar -->
            <sidebar class="admin-sidebar">
                <button class="admin-btn active" data-section="dashboard">üìä Dashboard</button>
                <button class="admin-btn" data-section="users">üë• Users</button>
                <button class="admin-btn" data-section="verification">üí† Verification</button>
                <button class="admin-btn" data-section="withdrawals">üí∞ Withdrawals</button>
                <button class="admin-btn" data-section="reports">‚ö†Ô∏è Reports</button>
                <button class="admin-btn" data-section="content">üìù Content</button>
                <button class="admin-btn" data-section="sa-reserve">üè¶ SA Reserve</button>
                <button class="admin-btn" data-section="analytics">üìà Analytics</button>
                <button class="admin-btn" data-section="logs">üìã Activity Logs</button>
            </sidebar>

            <!-- Main Content -->
            <div class="admin-content">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="admin-section active">
                    <h1>Dashboard</h1>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Total Users</h3>
                            <p class="stat-number" id="totalUsers">0</p>
                            <span class="stat-change" id="usersTrend">+0%</span>
                        </div>
                        <div class="stat-card">
                            <h3>Active Users (30d)</h3>
                            <p class="stat-number" id="activeUsers">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Verified Creators</h3>
                            <p class="stat-number" id="verifiedCreators">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Subscribed Users</h3>
                            <p class="stat-number" id="subscribedUsers">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>SA Reserve Balance</h3>
                            <p class="stat-number" id="reserveBalance">0 SA</p>
                        </div>
                        <div class="stat-card">
                            <h3>Total Withdrawn</h3>
                            <p class="stat-number" id="totalWithdrawn">$0</p>
                        </div>
                    </div>

                    <div class="charts-container">
                        <div class="chart-card">
                            <h3>User Growth</h3>
                            <canvas id="userGrowthChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>SA Utilization</h3>
                            <canvas id="saUtilizationChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Users Section -->
                <section id="usersSection" class="admin-section">
                    <h1>User Management</h1>
                    <div class="filters">
                        <input type="text" id="userSearch" placeholder="Search users...">
                        <select id="userStatusFilter">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="suspended">Suspended</option>
                            <option value="banned">Banned</option>
                        </select>
                    </div>
                    <table id="usersTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Followers</th>
                                <th>SA Balance</th>
                                <th>Joined</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr><td colspan="7" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- Verification Section -->
                <section id="verificationSection" class="admin-section">
                    <h1>Verification Approvals</h1>
                    <div class="verification-queue">
                        <h2>Pending Verification Requests</h2>
                        <table id="verificationTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Followers</th>
                                    <th>Requested</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="verificationTableBody">
                                <tr><td colspan="5" class="loading">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Withdrawals Section -->
                <section id="withdrawalsSection" class="admin-section">
                    <h1>Withdrawal Management</h1>
                    <div class="filters">
                        <select id="withdrawalStatusFilter">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="reviewing">Under Review</option>
                            <option value="approved">Approved</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                    <table id="withdrawalsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Amount</th>
                                <th>Currency</th>
                                <th>Status</th>
                                <th>Requested</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="withdrawalsTableBody">
                            <tr><td colspan="6" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- Reports Section -->
                <section id="reportsSection" class="admin-section">
                    <h1>User Reports</h1>
                    <table id="reportsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Reported User</th>
                                <th>Reason</th>
                                <th>Reported By</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reportsTableBody">
                            <tr><td colspan="6" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- Content Section -->
                <section id="contentSection" class="admin-section">
                    <h1>Content Moderation</h1>
                    <div class="filters">
                        <select id="contentTypeFilter">
                            <option value="">All Types</option>
                            <option value="post">Posts</option>
                            <option value="comment">Comments</option>
                        </select>
                        <select id="contentStatusFilter">
                            <option value="">All Status</option>
                            <option value="reported">Reported</option>
                            <option value="flagged">Flagged</option>
                        </select>
                    </div>
                    <table id="contentTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Author</th>
                                <th>Content</th>
                                <th>Type</th>
                                <th>Reports</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contentTableBody">
                            <tr><td colspan="5" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- SA Reserve Section -->
                <section id="reserveSection" class="admin-section">
                    <h1>SA Reserve Management</h1>
                    <div class="reserve-summary">
                        <div class="reserve-card">
                            <h3>Current Balance</h3>
                            <p class="reserve-amount" id="currentReserve">0 SA</p>
                        </div>
                        <div class="reserve-card">
                            <h3>This Month Spent</h3>
                            <p class="reserve-amount" id="monthlySpent">0 SA</p>
                        </div>
                        <div class="reserve-card">
                            <h3>This Month Earned</h3>
                            <p class="reserve-amount" id="monthlyEarned">0 SA</p>
                        </div>
                    </div>

                    <div class="reserve-actions">
                        <button class="btn btn-primary" id="allocateFundsBtn">Allocate Funds</button>
                        <button class="btn btn-secondary" id="viewReserveHistoryBtn">View History</button>
                    </div>

                    <div class="reserve-transactions">
                        <h2>Reserve Transactions</h2>
                        <table id="reserveTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Purpose</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="reserveTableBody">
                                <tr><td colspan="4" class="loading">Loading...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section id="analyticsSection" class="admin-section">
                    <h1>Analytics & Insights</h1>
                    <div class="analytics-tabs">
                        <button class="tab-btn active" data-period="weekly">Weekly</button>
                        <button class="tab-btn" data-period="monthly">Monthly</button>
                        <button class="tab-btn" data-period="yearly">Yearly</button>
                    </div>
                    <div id="analyticsContainer" class="analytics-grid">
                        <div class="chart-card">
                            <h3>SA Utilization</h3>
                            <canvas id="saAnalyticsChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>Withdrawal Trends</h3>
                            <canvas id="withdrawalTrendsChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h3>Engagement</h3>
                            <canvas id="engagementChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Activity Logs Section -->
                <section id="logsSection" class="admin-section">
                    <h1>Activity Logs</h1>
                    <div class="filters">
                        <select id="logTypeFilter">
                            <option value="">All Types</option>
                            <option value="user">User Actions</option>
                            <option value="moderation">Moderation</option>
                            <option value="payment">Payments</option>
                        </select>
                        <input type="date" id="logDateFilter">
                    </div>
                    <table id="logsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Admin</th>
                                <th>Action</th>
                                <th>Target</th>
                                <th>Details</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody id="logsTableBody">
                            <tr><td colspan="5" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </section>
            </div>
        </div>
    </div>

    <!-- Action Modals -->
    <div class="modal" id="actionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="actionModalTitle"></h2>
                <button class="modal-close" id="closeActionModal">&times;</button>
            </div>
            <div id="actionModalBody"></div>
        </div>
    </div>

    <script src="../js/config/supabase.js"></script>
    <script src="../js/config/constants.js"></script>
    <script src="../js/utils/helpers.js"></script>
    <script src="../js/auth/session.js"></script>
    <script src="../js/admin/admin.js"></script>
    <script src="../js/admin/moderation.js"></script>
    <script src="../js/admin/analytics.js"></script>
    <script src="../js/admin/sa-reserve.js"></script>
</body>
</html>
